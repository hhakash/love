<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Our Journey ‚ù§Ô∏è</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Caveat:wght@400;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --color-bg-start: #fff5f7; 
            --color-bg-end: #ffe4e1;    
        }

        * {
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
            outline: none;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: linear-gradient(135deg, var(--color-bg-start) 0%, var(--color-bg-end) 100%);
            font-family: 'Playfair Display', serif;
            position: fixed;
            touch-action: none;
        }

        /* Floating Background Elements */
        .bg-element {
            position: absolute;
            pointer-events: none;
            z-index: 0;
            animation: float 8s infinite ease-in-out;
            opacity: 0.15;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        .photocard {
            width: 85vw;
            max-width: 340px;
            height: 520px;
            background: white;
            border-radius: 12px;
            padding: 12px 12px 140px 12px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate3d(-50%, -50%, 0);
            z-index: 10;
            border: 1px solid rgba(0,0,0,0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            user-select: none;
            touch-action: none;
            will-change: transform;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            transform-style: preserve-3d;
        }

        @media (min-width: 768px) {
            .photocard { height: 580px; max-width: 380px; }
        }

        .photo-area {
            width: 100%;
            height: 280px;
            background: #fdfdfd;
            position: relative;
            border-radius: 6px;
            overflow: hidden;
        }

        .photo-area img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
        }

        .date-note {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #fffbe6;
            padding: 4px 10px;
            font-family: 'Caveat', cursive;
            font-size: 1.1rem;
            color: #444;
            transform: rotate(2deg);
            border: 1px solid rgba(0,0,0,0.08);
            z-index: 20;
        }

        .card-caption {
            margin-top: 12px;
            text-align: center;
            font-family: 'Caveat', cursive;
            font-size: 1.6rem;
            color: #111;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Classy Typography for Song Info */
        .song-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.85rem;
            letter-spacing: -0.01em;
            color: #111;
        }

        .song-artist {
            font-family: 'Montserrat', sans-serif;
            font-weight: 400;
            font-size: 0.7rem;
            color: #666;
            margin-top: 1px;
        }

        /* Thicker Seek Bar Styling */
        .seek-bar {
            -webkit-appearance: none;
            width: 100%;
            height: 8px; /* Thicker */
            background: #f0f0f0;
            border-radius: 10px;
            outline: none;
            margin: 14px 0;
            cursor: pointer;
            overflow: hidden;
        }

        .seek-bar::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #eee;
            border-radius: 4px;
        }

        .seek-bar::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 0; /* Hide default thumb to show fill color easily */
            box-shadow: -407px 0 0 400px #d63384; /* Creates the progress fill effect */
        }

        /* Heart Shape Play Button */
        .play-btn-heart {
            background: #d63384;
            color: white;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            clip-path: path('M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z');
            transition: transform 0.2s ease, background 0.2s ease;
            padding-bottom: 2px;
        }

        .play-btn-heart:active {
            transform: scale(0.9);
            background: #b52a6f;
        }

        #intro-loader {
            background: #fff5f7;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .loading-bar-container {
            width: 240px;
            height: 6px;
            background: #eee;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
        }

        #loading-bar-fill {
            width: 0%;
            height: 100%;
            background: #d63384;
            transition: width 0.1s ease;
        }

        .hidden { display: none !important; }
        
        @keyframes pulse-heart {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }
        .pulse-heart { animation: pulse-heart 1.2s infinite ease-in-out; }
    </style>
</head>
<body>

    <div id="main-wrapper" class="relative w-full h-full">
        
        <div id="intro-loader" class="fixed inset-0">
            <div class="pulse-heart text-6xl mb-6">‚ù§Ô∏è</div>
            <h2 class="font-handwriting text-2xl text-pink-600 italic" id="loading-text">Loading my love for you...</h2>
            <div class="loading-bar-container">
                <div id="loading-bar-fill"></div>
            </div>
            <div id="percent-text" class="mt-2 text-sm font-sans text-pink-400">0%</div>
            
            <button id="start-btn" onclick="beginJourney()" class="hidden mt-8 bg-[#d63384] text-white px-10 py-3 rounded-full font-serif active:scale-95 transition-transform">
                Open Your Heart
            </button>
        </div>

        <!-- Extra Background Elements -->
        <div id="bg-decorations" class="fixed inset-0 overflow-hidden pointer-events-none"></div>

        <div id="card-container" class="relative w-full h-full flex items-center justify-center hidden opacity-0 transition-opacity duration-1000"></div>

        <div id="final-screen" class="fixed inset-0 hidden flex flex-col items-center justify-center text-center p-8 bg-white z-[400]">
            <h2 class="text-4xl font-serif mb-12">WILL YOU BE MY GIRLFRIEND?</h2>
            <div class="flex flex-col space-y-4 w-full max-w-xs">
                <button onclick="handleResponse('yes')" class="bg-[#d63384] text-white py-4 rounded-full text-xl font-serif">YES</button>
                <button id="no-btn" onmouseover="moveNo()" ontouchstart="moveNo()" class="border-2 border-gray-200 text-gray-400 py-4 rounded-full text-xl font-serif">NO</button>
            </div>
        </div>
    </div>

    <audio id="audio-player" playsinline></audio>

    <script>
        const cardsData = [
            { id: 1, title: "Our First Hangout", date: "28-Nov", song: "The Night We Met", artist: "Lord Huron", img: "files/Our-First-Hangout.jpg", mp3: "files/Our-First-Hangout.mp3" },
            { id: 2, title: "First Rickshaw Ride", date: "31-Oct", song: "Until I Found You", artist: "Stephen Sanchez", img: "files/First-Rickshaw-Ride.jpg", mp3: "files/First-Rickshaw-Ride.mp3" },
            { id: 3, title: "First Proper Date?", date: "10-Nov", song: "Afreen Afreen", artist: "RFAK, Momina", img: "files/First-Proper-Date.jpg", mp3: "files/First-Proper-Date.mp3" },
            { id: 4, title: "Charukola Dateee", date: "16-Nov", song: "Darale Duaarey", artist: "Nandita X Ishaan", img: "files/Charukola_Dateee.jpg", mp3: "files/Charukola_Dateee.mp3" },
            { id: 5, title: "Postering with Poster Girl", date: "17-Nov", song: "Something About You", artist: "Eyedress", img: "files/Postering.jpg", mp3: "files/Postering.mp3" },
            { id: 6, title: "Saviour of the Day", date: "19-Nov", song: "Wonderwall", artist: "Oasis", img: "files/Saviour.jpg", mp3: "files/Saviour.mp3" },
            { id: 7, title: "A Colorful Night", date: "19-Nov", song: "Echo of Love", artist: "The Shutes", img: "files/Color.jpg", mp3: "files/Color.mp3" },
            { id: 8, title: "A Date with Sunflower", date: "23-Nov", song: "Sunflower", artist: "Post Malone, Swae Lee", img: "files/Sunflower.jpg", mp3: "files/Sunflower.mp3" },
            { id: 9, title: "Breaking the Matrix", date: "26-Nov", song: "Iraaday", artist: "Abdul Hannan & Rovalio", img: "files/Matrix.jpg", mp3: "files/Matrix.mp3" },
            { id: 10, title: "Posh Date", date: "28-Nov", song: "60s Love", artist: "Level Five", img: "files/Posh.jpg", mp3: "files/Posh.mp3" },
            { id: 11, title: "Stunningly Beautiful", date: "29-Nov", song: "Gulbahar", artist: "Ishaan, Shuvendu", img: "files/Beautiful.jpg", mp3: "files/Beautiful.mp3" },
            { id: 12, title: "Her & Spidey", date: "1-Dec", song: "Blue", artist: "Yung Kai", img: "files/Spidey.jpg", mp3: "files/Spidey.mp3" },
            { id: 13, title: "Winter Wondering", date: "4-Dec", song: "Snowman", artist: "Sia", img: "files/Winter.jpg", mp3: "files/Winter.mp3" },
            { id: 14, title: "BBQ Night", date: "7-Dec", song: "Can't Help Falling in Love With You", artist: "Elvis Presley", img: "files/BBQ.jpg", mp3: "files/BBQ.mp3" },
            { id: 15, title: "Heavenly Day", date: "9-Dec", song: "Heavenly", artist: "Cigarettes After Sex", img: "files/Heaven.jpg", mp3: "files/Heaven.mp3" },
            { id: 16, title: "Sha-Pa Date", date: "11-Dec", song: "Amar Jaan", artist: "Dameer", img: "files/Jaan.jpg", mp3: "files/Jaan.mp3" },
            { id: 17, title: "Kiss", date: "13-Dec", song: "Sailor Song", artist: "Gigi Perez", img: "files/Kiss.jpg", mp3: "files/Kiss.mp3" },
            { id: 18, title: "Flowers from Flower", date: "17-Dec", song: "Ekanto Golap", artist: "Indalo", img: "files/Golap.jpg", mp3: "files/Golap.mp3" },
            { id: 19, title: "Yapping Queen", date: "18-Dec", song: "My Love My All Mine", artist: "Mitski", img: "files/Yap.jpg", mp3: "files/Yap.mp3" },
            { id: 20, title: "God's Greatest Artwork", date: "21-Dec", song: "Bright Blue Berlin Sky", artist: "The Shutes", img: "files/Art.jpg", mp3: "files/Art.mp3" },
            { id: 21, title: "Surprise Attack", date: "23-Dec", song: "Jo Tum Mere Ho", artist: "Anuv Jain", img: "files/Mine.jpg", mp3: "files/Mine.mp3" },
            { id: 22, title: "My Warmth", date: "29-Dec", song: "Snowman", artist: "Sia", img: "files/Snowman.jpg", mp3: "files/Snowman.mp3" },
            { id: 23, title: "Bou", date: "4-Jan", song: "EVERYTHING", artist: "The Black Skirts", img: "files/Bou.jpg", mp3: "files/Bou.mp3" },
            { id: 24, title: "Meeting her Fan", date: "5-Jan", song: "Luther", artist: "Kendrick Lamar", img: "files/Fan.jpg", mp3: "files/Fan.mp3" },
            { id: 25, title: "My Bestie with My Love", date: "6-Jan", song: "DtMF", artist: "Bad Bunny", img: "files/Bestie.jpg", mp3: "files/Bestie.mp3" },
            { id: 26, title: "A CoIncidental Date", date: "8-Jan", song: "Loverboy", artist: "A-Wall", img: "files/Coincidence.jpg", mp3: "files/Coincidence.mp3" },
            { id: 27, title: "Silly Study Date", date: "11-Jan", song: "Roi", artist: "Videoclub", img: "files/Study.jpg", mp3: "files/Study.mp3" },
            { id: 28, title: "British Cosplay", date: "13-Jan", song: "Die With A Smile", artist: "Lady Gaga, Bruno Mars", img: "files/British.jpg", mp3: "files/British.mp3" },
            { id: 29, title: "The Best Grip", date: "15-Jan", song: "Take on Me", artist: "A-Ha", img: "files/Grip.jpg", mp3: "files/Grip.mp3" },
            { id: 30, title: "Surprise Meet", date: "18-Jan", song: "No One Noticed", artist: "The Marinas", img: "files/Surprise.jpg", mp3: "files/Surprise.mp3" },
            { id: 31, title: "Softies Date", date: "19-Jan", song: "I love you So", artist: "The Walters", img: "files/Softy.jpg", mp3: "files/Softy.mp3" },
            { id: 32, title: "Date with Prettiest Girl", date: "20-Jan", song: "I think they call this Love", artist: "Elliot James Reay", img: "files/Dilnawaz.jpg", mp3: "files/Dilnawaz.mp3" },
            { id: 33, title: "Exam Shenanigans", date: "22-Jan", song: "Honeypie", artist: "Jawny", img: "files/Exam.jpg", mp3: "files/Exam.mp3" },
            { id: 34, title: "My Goddess", date: "23-Jan", song: "Tumi", artist: "Level Five", img: "files/Goddess.jpg", mp3: "files/Goddess.mp3" },
            { id: 35, title: "Shopping Date", date: "26-Jan", song: "Blue", artist: "Yung Kai", img: "files/Shopping.jpg", mp3: "files/Shopping.mp3" },
            { id: 36, title: "Kiss in the Dept", date: "28-Jan", song: "Apocalypse", artist: "Cigarettes After Sex", img: "files/Dept.jpg", mp3: "files/Dept.mp3" },
            { id: 37, title: "Dolled up Baby", date: "30-Jan", song: "Pretty Little Baby", artist: "Connie Francis", img: "files/Doll.jpg", mp3: "files/Doll.mp3" },
            { id: 38, title: "Night Out", date: "31-Jan", song: "This Town", artist: "Niall Horan", img: "files/Night.jpg", mp3: "files/Night.mp3" },
            { id: 39, title: "Happy Valentines", date: "2-Feb", song: "Make You Mine", artist: "Public", img: "files/Valentines.jpg", mp3: "files/Valentines.mp3" },
            { id: 40, title: "Peshawarain Date Night", date: "3-Feb", song: "Instant Crush", artist: "Daft Punk", img: "files/Peshawarain.jpg", mp3: "files/Peshawarain.mp3" },
            { id: 41, title: "Traditional Princess", date: "5-Feb", song: "Telepatia", artist: "Kali Uchis", img: "files/BD.jpg", mp3: "files/BD.mp3" },
            { id: 42, title: "Sorry", date: "6-Feb", song: "Line Without A Hook", artist: "Ricky Montgomery", img: "files/Sorry.jpg", mp3: "files/Sorry.mp3" },
            { id: 43, title: "Through sickness and Love", date: "8-Feb", song: "All of the Stars", artist: "Hayd", img: "files/Sick.jpg", mp3: "files/Sick.mp3" },
            { id: 44, title: "Longest Wait Ever", date: "15-Feb", song: "As It Was", artist: "Harry Styles", img: "files/Wait.jpg", mp3: "files/Wait.mp3" },
            { id: 45, title: "The Day", date: "16-Feb", song: "Say Yes To Heaven", artist: "Lana Del Rey", img: "files/No-Pic.jpg", mp3: "files/Yes.mp3" }
        ];

        let currentIndex = 0;
        const audio = document.getElementById('audio-player');
        const container = document.getElementById('card-container');

        window.addEventListener('load', () => {
            const bar = document.getElementById('loading-bar-fill');
            const percent = document.getElementById('percent-text');
            const btn = document.getElementById('start-btn');
            const txt = document.getElementById('loading-text');
            
            let prog = 0;
            const interval = setInterval(() => {
                prog += Math.floor(Math.random() * 5) + 2;
                if (prog >= 100) {
                    prog = 100;
                    clearInterval(interval);
                    txt.innerText = "Love loaded successfully.";
                    btn.classList.remove('hidden');
                }
                bar.style.width = prog + '%';
                percent.innerText = prog + '%';
            }, 60);
        });

        function beginJourney() {
            document.getElementById('intro-loader').classList.add('hidden');
            container.classList.remove('hidden');
            setTimeout(() => { container.style.opacity = '1'; }, 50);
            renderCurrentStack();
            initDecorations();
        }

        function renderCurrentStack() {
            container.innerHTML = '';
            for (let i = currentIndex + 2; i >= currentIndex; i--) {
                if (i < cardsData.length) createCard(cardsData[i], i);
            }
            playCurrentSong();
        }

        function createCard(data, index) {
            const card = document.createElement('div');
            card.className = 'photocard';
            card.id = `card-${index}`;
            card.style.zIndex = 100 - index;
            
            const rot = (index % 2 === 0 ? 1 : -1) * (Math.random() * 3);
            card.style.transform = `translate3d(-50%, -50%, 0) rotate(${rot}deg)`;

            card.innerHTML = `
                <div class="photo-area">
                    <div class="date-note">${data.date}</div>
                    <img src="${data.img}" alt="memory" onerror="this.src='https://via.placeholder.com/340x280?text=‚ù§Ô∏è'">
                </div>
                <div class="card-caption">${data.title}</div>
                <div class="spotify-player mt-4 px-1">
                    <div class="flex items-center justify-between">
                        <div class="overflow-hidden flex-1 pr-2">
                            <p class="song-title truncate">${data.song}</p>
                            <p class="song-artist truncate">${data.artist}</p>
                        </div>
                        <button class="play-btn-heart active:scale-90 transition-transform">
                            <svg class="play-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-left: 1px;">
                                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                            </svg>
                        </button>
                    </div>
                    <input type="range" class="seek-bar" value="0" step="0.1" min="0" max="100">
                </div>
            `;

            const playBtn = card.querySelector('.play-btn-heart');
            const seekBar = card.querySelector('.seek-bar');

            playBtn.onclick = (e) => {
                e.stopPropagation();
                if (audio.paused) {
                    audio.play();
                    updatePlayIcon(true, playBtn);
                } else {
                    audio.pause();
                    updatePlayIcon(false, playBtn);
                }
            };

            seekBar.oninput = (e) => {
                e.stopPropagation();
                if (audio.duration) {
                    const seekTo = (seekBar.value / 100) * audio.duration;
                    audio.currentTime = seekTo;
                }
            };
            
            seekBar.onclick = (e) => e.stopPropagation();
            seekBar.ontouchstart = (e) => e.stopPropagation();

            let startX = 0, curX = 0, isDragging = false;

            const move = (e) => {
                if (!isDragging) return;
                curX = (e.type.includes('touch') ? e.touches[0].clientX : e.clientX) - startX;
                card.style.transform = `translate3d(calc(-50% + ${curX}px), -50%, 0) rotate(${rot + (curX/20)}deg)`;
            };

            const end = () => {
                if (!isDragging) return;
                isDragging = false;
                card.style.transition = 'transform 0.4s ease-out';
                if (Math.abs(curX) > 120) {
                    card.style.transform = `translate3d(${curX > 0 ? 1000 : -1000}px, -50%, 0) rotate(${curX/10}deg)`;
                    setTimeout(() => {
                        currentIndex++;
                        currentIndex < cardsData.length ? renderCurrentStack() : showFinal();
                    }, 300);
                } else {
                    card.style.transform = `translate3d(-50%, -50%, 0) rotate(${rot}deg)`;
                }
            };

            card.onmousedown = (e) => { if(index===currentIndex) { isDragging=true; startX=e.clientX; card.style.transition='none'; } };
            card.ontouchstart = (e) => { if(index===currentIndex) { isDragging=true; startX=e.touches[0].clientX; card.style.transition='none'; } };
            
            window.onmousemove = move;
            window.ontouchmove = (e) => { if(isDragging) { move(e); if(e.cancelable) e.preventDefault(); } };
            window.onmouseup = end;
            window.ontouchend = end;

            container.appendChild(card);
        }

        function updatePlayIcon(isPlaying, btn) {
            const icon = btn.querySelector('.play-icon');
            if (isPlaying) {
                icon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>';
                icon.style.marginLeft = "0px";
            } else {
                icon.innerHTML = '<path d="M8 5v14l11-7z"/>';
                icon.style.marginLeft = "2px";
            }
        }

        function playCurrentSong() {
            if (currentIndex < cardsData.length) {
                audio.src = cardsData[currentIndex].mp3;
                audio.play().then(() => {
                    const btn = document.querySelector(`#card-${currentIndex} .play-btn-heart`);
                    if (btn) updatePlayIcon(true, btn);
                }).catch(() => {});
            }
        }

        audio.ontimeupdate = () => {
            const seekBar = document.querySelector(`#card-${currentIndex} .seek-bar`);
            if (seekBar && audio.duration) {
                seekBar.value = (audio.currentTime / audio.duration) * 100;
            }
        };

        function showFinal() {
            container.classList.add('hidden');
            document.getElementById('final-screen').classList.remove('hidden');
            audio.src = "files/Yes.mp3";
            audio.play().catch(() => {});
        }

        function handleResponse(res) {
            if (res === 'yes') {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                document.body.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full w-full text-center p-8 bg-[#fff5f7]">
                        <h1 class="text-5xl font-serif text-[#d63384] mb-8 pulse-heart">IT'S OFFICIAL!</h1>
                        <p class="text-2xl font-handwriting">hha loves ppita and ppita loves hha</p>
                    </div>
                `;
            }
        }

        function moveNo() {
            const btn = document.getElementById('no-btn');
            btn.style.position = 'fixed';
            btn.style.left = Math.random() * 60 + 20 + '%';
            btn.style.top = Math.random() * 60 + 20 + '%';
        }

        function initDecorations() {
            const bg = document.getElementById('bg-decorations');
            const items = ['‚ù§Ô∏è', '‚ú®', 'üå∏', 'üíñ', '‚òÅÔ∏è'];
            for(let i=0; i<25; i++) {
                const el = document.createElement('div');
                el.className = 'bg-element';
                el.style.left = Math.random() * 100 + '%';
                el.style.top = Math.random() * 100 + '%';
                el.style.fontSize = (Math.random() * 15 + 15) + 'px';
                el.style.animationDelay = (Math.random() * 5) + 's';
                el.style.animationDuration = (Math.random() * 4 + 6) + 's';
                el.innerText = items[Math.floor(Math.random() * items.length)];
                bg.appendChild(el);
            }
        }
    </script>
</body>
</html>
